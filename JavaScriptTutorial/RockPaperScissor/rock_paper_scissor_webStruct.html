<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rock Paper Scissors</title>
  </head>
  <link rel="stylesheet" href="rock_paper.css" />
  <body>
    <p class="title">
      Rock Paper Scissors
    </p>
    <div class="rock_paper_body">
      <div class="paper">
        <img
          src="src/paper.png"
          width="100px"
          onclick="
              playGame('Paper');
              updateScoreBoard();
              updateMove();
              updateScoreBoardImage()
            "
        />
      </div>
      <div class="scissor">
        <img
          src="src/scissors.png"
          width="100px"
          onclick="
              playGame('Scissor');
              updateScoreBoard();
              updateMove();
              updateScoreBoardImage();
            "
        />
      </div>
      <div class="rock">
        <img
          src="src/rock.png"
          width="100px"
          onclick="
              playGame('Rock');
              updateScoreBoard();
              updateMove();
              updateScoreBoardImage();
            "
        />
      </div>
    </div>
    <div id="move-info">
      <img id="js-user-move" src="">
      <img id="js-computer-move" src=">
    </div>
    <div id="status">
      <img src="" id="js-status-image">
    </div>
    <div id="main_butt">
      <div class="_main">
        <button
          type="button"
          onclick="
          score.wins = 0
          score.loss = 0
          score.ties = 0
          localStorage.removeItem('score')
          updateScoreBoard();
          console.log(`Scores Reseted to 0`);
          "
          class="reset-button"
        >
          Reset Scores
        </button>

        <!-- <button
          type="button"
          onclick="
          let parsed_data = JSON.parse(localStorage.getItem('score')) ||  {
              wins: 0,
              loss: 0,
              ties: 0,
          };
          // alert(`Current Score is: Wins: ${parsed_data.wins}, loss: ${parsed_data.loss} and ties: ${parsed_data.ties}`)
        "
        >
          Show Scores
        </button> -->
        <br />
        <div id="score">
          <p id="js-wins">Wins:0</p>
          <p id="js-loss">Loss:0</p>
          <p id="js-ties">Ties:0</p>
        </div>
      </div>
    </div>

    <!------------------------------------------------------------------------------------------------------------ -->
    <!-- Script -->
    <script>
      let cm;
      let playerMove = '';
      let res = "";
      let score = JSON.parse(localStorage.getItem("score")) || {
        wins: 0,
        loss: 0,
        ties: 0,
      };
      // DOM
      function updateScoreBoard(){
        document.querySelector('#js-wins').innerHTML  = `Wins:${score.wins}`;
        document.querySelector('#js-loss').innerHTML  = `Losses:${score.loss}`;
        document.querySelector('#js-ties').innerHTML  = `Ties:${score.ties}`;
      };

      function updateMove(){
        const elmntplayerMove = document.querySelector('#js-user-move');
        const computerMove = document.querySelector('#js-computer-move');
        const moveInfo = document.getElementById('move-info')
        moveInfo.style.visibility = `visible`
        if(playerMove === 'Rock'){
          elmntplayerMove.setAttribute('src','src/rock.png')
        }
        else if(playerMove === 'Scissor'){
          elmntplayerMove.setAttribute('src','src/scissors.png')
        }
        else{
          elmntplayerMove.setAttribute('src','src/paper.png')
        }
        // computer Move
        if(cm === 'Rock'){
          computerMove.setAttribute('src','src/rock.png')
        }
        else if(cm === 'Scissor'){
          computerMove.setAttribute('src','src/scissors.png')
        }
        else{
          computerMove.setAttribute('src','src/paper.png')
        }
      };

      function updateScoreBoardImage(){
        const elementImg = document.querySelector('#js-status-image');
        if(res === 'wins'){
          elementImg.setAttribute('src',`src/success.png`);
        }
        else if(res === 'loss'){
          elementImg.setAttribute('src',`src/game-over.png`)
        }
        else if(res === 'Tie'){
          elementImg.setAttribute('src',`src/draw.png`)
        }
      };

      function computerMove() {
        let computer_mv = "";
        let computer = Math.random();

        if (computer >= 0 && computer < 1 / 3) {
          computer_mv = "Rock";
          console.log(`Computer = Rock`);
        } else if (computer >= 1 / 3 && computer < 2 / 3) {
          console.log(`Computer = Paper`);
          computer_mv = "Paper";
        } else if (computer >= 2 / 3 && computer < 1) {
          console.log(`Computer = Scissor`);
          computer_mv = "Scissor";
        }
        return computer_mv;
      }

      function playGame(playerMv) {
        cm = computerMove();
        playerMove = playerMv;
        if (playerMove === "Scissor") {
          if (cm === "Rock") {
            res = "loss";
          } else if (cm === "Paper") {
            res = "wins";
          } else if (cm === "Scissor") {
            res = "Tie";
          }
        } else if (playerMove === "Rock") {
          if (cm === "Paper") {
            res = "loss";
          } else if (cm === "Scissor") {
            res = "wins";
          } else if (cm === "Rock") {
            res = "Tie";
          }
        } else if (playerMove == "Paper") {
          if (cm === "Scissor") {
            res = "loss";
          } else if (cm === "Rock") {
            res = "wins";
          } else if (cm === "Paper") {
            res = "Tie";
          }
        }
        // calculating the overall res
        if (res === "wins") {
          // alert(
          //   `Congrats!! 🎉 You Win:\n\rYou choose:${playerMove}, Computer Choose:${cm}`
          // );
          score["wins"] += 1;
        } else if (res === "loss") {
          // alert(
          //   `Oops!! 😭 You loose ....:\n\rYou choose:${playerMove}, Computer Choose:${cm}`
          // );
          score["loss"] += 1;
        } else {
          // alert(
          //   `huuuuuh.... it Tie !! 😮‍💨\n\rYou choose:${playerMove}, Computer Choose:${cm}`
          // );
          score["ties"] += 1;
        }
        localStorage.setItem("score", JSON.stringify(score));
      }

      updateScoreBoard(score);
    </script>
  </body>
</html>
